{% extends "base.html" %}
{% block title %}{{ shoe.name }} - Buy Now | New Sole{% endblock %}
{% block meta_description %}Get your hands on {{ shoe.name }} â€” limited edition and available only at New Sole.
Worldwide shipping.{% endblock %}
{% block meta_keywords %}{{ shoe.name }}, limited edition sneakers, exclusive drops, New Sole{% endblock %}


{% block content %}

<div class="container mt-5 text-start">
    {% include 'breadcrumbs.html' %}
    <div class="container">

        <h1> {{ title }} </h1>
        <div class="row">
            <div class="col-sm-8">
                <img src="{{ shoe.image.url }}" alt="{{ shoe.name }}" class="img-fluid">
            </div>
            <div class="col-sm-4 shoe-detail">
                <div class="container">
                    <h3 class="fw-bold pt-2">{{ shoe.name }}</h3>
                    <small class="pt-2"> {% for category in shoe.categories %}
                        <mark>{{ category }}</mark>
                        {% endfor %}
                    </small>
                    <p class="fw-light pt-2">{{ shoe.description }}</p>

                    <div class="d-flex justify-content-start gap-3 pt-2">
                        <h4><strong>${{ shoe.price }}</strong></h4>
                        <small class="pt-1">SKU: {{ shoe.product_code }}</small>
                    </div>


                    {% if shoe.quantity >= 5 %}
                    <p>In Stock</p>
                    <div class="row align-middle">
                        <div class="col-10 d-grid gap-2 col-6 mx-auto">
                            <a href="{% url 'add_cart' shoe.id %}" class="btn btn-primary">Add
                                to
                                Cart</a>

                        </div>

                        <div class="col-2 d-flex justify-content-center align-items-center"><a
                                href="{% url 'add_to_wishlist' shoe.id %}"><i class="bi bi-bag-heart"
                                    style="font-size: 1.5rem"></i></a></div>
                    </div>
                    {% elif shoe.quantity >= 1 %}
                    <div class="row align-middle">
                        <div class="col-10 d-grid gap-2 col-6 mx-auto">
                            <a href="{% url 'add_cart' shoe.id %}" class="btn btn-primary">Add
                                to
                                Cart</a>

                        </div>

                        <div class="col-2 d-flex justify-content-center align-items-center"><a
                                href="{% url 'add_to_wishlist' shoe.id %}"><i class="bi bi-bag-heart"
                                    style="font-size: 1.5rem"></i></a></div>
                    </div>
                </div>
                <h6 class="pt-2">Last few pieces left!</h6>
                {% else %}
                <div>
                    <p>Out of Stock</p>
                    <p><a href="{% url 'signup' %}">Sign up</a> to be notified of restocks!</p>
                </div>
                {% endif %}



            </div>
        </div>
    </div>
</div>


<button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
    aria-controls="offcanvasRight">Toggle right offcanvas</button>

<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasRightLabel">Offcanvas right</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        {% if shoes %}
        <table>
            <tr>
                <th>Item</th>
                <th>Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Item Total Price</th>
                <th>Action</th>
            </tr>
            {% for shoe in shoes %}
            <tr>
                <td><img src="{{ shoe.image.url }}" alt="{{ shoe.name }}" class="card-img-top"
                        style="height:40px; width:auto"></td>
                <td>{{ shoe.name }}</td>
                <td>${{ shoe.price }}</td>
                <td>{{ shoe.cart_quantity }}</td>
                <td>{{ shoe.line_total }}</td>
                <td>
                    <a href="{% url 'shoe_detail' shoe.slug %}">View Details</a>
                    <a href="{% url 'move_cart_to_wishlist' shoe.id %}">Move to Wishlist</a>
                    <a href="{% url 'add_cart' shoe.id %}">+</a>
                    <a href="{% url 'remove_from_cart' shoe.id %}">-</a>
                    <a href="{% url 'remove_all_from_cart' shoe.id %}">Delete</a>
                </td>
            </tr>
            {% endfor %}
        </table>

        <p><strong>Grand Total: ${{ cart_total|floatformat:2 }}</strong></p>
        {% else %}
        <p>Your cart is empty.</p>
        {% endif %}

    </div>
</div>

{% endblock %}